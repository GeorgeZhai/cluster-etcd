// Workaround for BuildParams.internal -> BuildParams.isInternal API change
// This patches the BuildParams class to add the missing 'internal' property

gradle.beforeProject { project ->
    try {
        def buildParamsClass = Class.forName('org.opensearch.gradle.info.BuildParams')
        if (!buildParamsClass.metaClass.hasProperty(buildParamsClass, 'internal')) {
            buildParamsClass.metaClass.static.getInternal = {
                return buildParamsClass.isInternal
            }
        }
    } catch (Exception e) {
        // Ignore if BuildParams class doesn't exist or already has the property
        logger.debug("Could not patch BuildParams: ${e.message}")
    }
}

